@startuml Architecture Overview
skinparam backgroundColor #FFFFFF
skinparam componentStyle rectangle
skinparam shadowing false
skinparam ArrowColor #555555
skinparam ClassFontColor #1F2937
skinparam ClassBorderColor #94A3B8
skinparam ClassBackgroundColor #F8FAFC
skinparam ArrowThickness 1

package "Workspace: cortex/" {
  [01-Projects]
  [02-Neural-Links]
  [03-Decisions]
  [04-Code-Fragments]
  [05-Insights]
  [07-Reports]
  [08-Docs]
  [00-System]
}

package "CLI Package: cortex-cli" {
  [cortex.cli.main]
  [cortex.cli.linking]
  [cortex.cli.analysis]
  [cortex.cli.testing]
  [cortex.cli.ai]
  [cortex.core.rule_based_linker]
  [cortex.core.cross_vault_linker]
  [cortex.cli.config]
}

package "AI App: cortex-ai (to be implemented)" {
  [FastAPI App]
  [Endpoints: /chat, /analyze, /validate]
}

[cortex.cli.ai] --> [cortex.integrations.cortex_ai.client] : uses (Mock)
[cortex.cli.linking] --> [cortex.core.rule_based_linker]
[cortex.cli.linking] --> [cortex.core.cross_vault_linker]
[cortex.cli.analysis] --> [cortex.core.*]

[cortex.core.rule_based_linker] ..> [00-System] : link_rules.yaml
[cortex.core.rule_based_linker] --> [Workspace: cortex/] : scans/updates md files
[cortex.core.cross_vault_linker] --> [Workspace: cortex/] : scans/validates links

[FastAPI App] ..> [Workspace: cortex/] : optional access (future)
[cortex.integrations.cortex_ai.client] ..> [FastAPI App] : future HTTP

'" Pattern annotations
note right of [cortex.cli.main]
  Facade: zentrales CLI-Entry-Point,
  bündelt Unterkommandos (Command-Invoker)
end note

note right of [cortex.cli.linking]
  Command: führt Linking-Workflows aus
end note

note right of [cortex.core.rule_based_linker]
  Rule Engine & data-driven design (YAML-Regeln)
end note

note right of [cortex.integrations.cortex_ai.client]
  Adapter/Gateway zum AI-Service (Ports & Adapters)
end note

legend right
  Layered Architecture:
    CLI (Presentation) → Core (Domain) → Integrations (Infra) → Workspace (Data)
  Ports & Adapters:
    CLI spricht Domain; AI-Client kapselt externen Service
  Client-Server:
    CLI ↔ (künftig) FastAPI /chat, /analyze, /validate
endlegend
@enduml
